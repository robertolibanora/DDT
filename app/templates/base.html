<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}DDT Processor{% endblock %}</title>
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="stylesheet" href="/static/css/design-system.css">
    <link rel="stylesheet" href="/static/css/preview_modal.css">
    {% block extra_css %}{% endblock %}
</head>
<body>
    <header>
        <div class="header-logo-title">
            <img src="/static/logo.png" alt="Logo" class="header-logo">
            <h1>{% block header_title %}DDT Processor{% endblock %}</h1>
        </div>
        <nav aria-label="Navigazione principale">
            <a href="/dashboard" id="nav-dashboard" aria-label="Vai alla dashboard">Dashboard</a>
            <a href="/upload" id="nav-upload" aria-label="Carica un nuovo DDT">Carica</a>
            <a href="/rules" id="nav-rules" aria-label="Gestisci le regole">Regole</a>
            <a href="/models" id="nav-models" aria-label="Visualizza i modelli di layout">Modelli</a>
            <a href="/logout" id="nav-logout" style="margin-left: auto;" aria-label="Esci dal sistema">Logout</a>
        </nav>
        {% block header_extra %}{% endblock %}
    </header>

    {% block messages %}{% endblock %}

    <main id="main-content">
        {% block content %}{% endblock %}
    </main>

    <footer>
        <p>DDT Processor - Sistema di gestione Documenti di Trasporto</p>
    </footer>

    {% block scripts %}{% endblock %}
    <script src="/static/js/preview_modal.js"></script>
    <script>
        // Evidenzia il link di navigazione attivo
        (function() {
            const path = window.location.pathname;
            const navUpload = document.getElementById('nav-upload');
            const navDashboard = document.getElementById('nav-dashboard');
            const navRules = document.getElementById('nav-rules');
            const navModels = document.getElementById('nav-models');
            
            if (path === '/dashboard') {
                if (navDashboard) navDashboard.classList.add('active');
            } else if (path === '/upload') {
                if (navUpload) navUpload.classList.add('active');
            } else if (path === '/rules') {
                if (navRules) navRules.classList.add('active');
            } else if (path === '/models') {
                if (navModels) navModels.classList.add('active');
            }
        })();
    </script>
</body>
</html>

